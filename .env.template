# ============================================================
# Headlesshost MCP Server — Environment Variables
# Copy this file to .env for local development
# ============================================================

# ------------------------------------------------------------
# Transport
# stdio  — for Claude Desktop / Claude Code (default)
# http   — for remote/container deployments (ChatGPT, etc.)
# ------------------------------------------------------------
MCP_TRANSPORT=http

# HTTP server bind address and port (http transport only)
MCP_HOST=0.0.0.0
MCP_PORT=3001

# Public URL of the MCP endpoint — used in OAuth metadata responses.
# Must match what clients will connect to (e.g. your ALB/ngrok URL).
MCP_PUBLIC_BASE_URL=https://api.headlesshost.com/mcp

# ------------------------------------------------------------
# MCP Auth Mode (http transport only)
# none   — no auth at MCP edge (rely on HEADLESSHOST_API_KEY)
# oauth  — bearer token required for all MCP calls (ChatGPT)
# mixed  — accepts calls with or without bearer token
# ------------------------------------------------------------
MCP_AUTH_MODE=oauth

# OIDC issuer used to build OAuth metadata advertised to clients.
# Required when MCP_AUTH_MODE is oauth or mixed.
MCP_OIDC_ISSUER_URL=MCP_OIDC_ISSUER_URL_VAR

# Expected audience value (optional — included in metadata hints)
MCP_OIDC_AUDIENCE=https://api.headlesshost.com

# Space-separated list of scopes to advertise
MCP_OIDC_SCOPES=kapiti.read kapiti.write kapiti.admin

# How long (ms) a validated bearer token is cached before re-checking.
# Tokens are also evicted when their JWT exp claim is reached.
MCP_TOKEN_VERIFY_CACHE_TTL_MS=60000

# ------------------------------------------------------------
# Headlesshost API
# ------------------------------------------------------------

# Base URL for the Kapiti API this MCP proxies to
HEADLESSHOST_API_BASE_URL=https://api.headlesshost.com

# Legacy API key — used as a fallback when no OAuth bearer token is present.
# Obtain from the Headlesshost dashboard.
HEADLESSHOST_API_KEY=SecretKeyFromDashboard

# Set to false to disable the legacy key fallback and require OAuth tokens only.
ALLOW_LEGACY_API_KEY_FALLBACK=false
